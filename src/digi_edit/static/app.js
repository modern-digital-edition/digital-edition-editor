(function(e){function t(t){for(var a,i,o=t[0],u=t[1],c=t[2],d=0,h=[];d<o.length;d++)i=o[d],Object.prototype.hasOwnProperty.call(n,i)&&n[i]&&h.push(n[i][0]),n[i]=0;for(a in u)Object.prototype.hasOwnProperty.call(u,a)&&(e[a]=u[a]);l&&l(t);while(h.length)h.shift()();return s.push.apply(s,c||[]),r()}function r(){for(var e,t=0;t<s.length;t++){for(var r=s[t],a=!0,o=1;o<r.length;o++){var u=r[o];0!==n[u]&&(a=!1)}a&&(s.splice(t--,1),e=i(i.s=r[0]))}return e}var a={},n={app:0},s=[];function i(t){if(a[t])return a[t].exports;var r=a[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=a,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)i.d(r,a,function(t){return e[t]}.bind(null,a));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/ui/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],u=o.push.bind(o);o.push=t,o=o.slice();for(var c=0;c<o.length;c++)t(o[c]);var l=u;s.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("cd49")},cd49:function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var a=r("2b0e"),n=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{attrs:{id:"app"}},[e.$store.state.busy?r("div",{attrs:{id:"busy"}},[r("progress",{attrs:{max:e.$store.state.maxBusyCounter},domProps:{value:e.$store.state.completedBusyCounter}})]):e._e(),r("nav",{staticClass:"main"},[r("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var a=t.keyboardNav;return[r("ul",{attrs:{role:"menubar"}},[r("li",{attrs:{role:"presentation"}},[r("span",[e._v("Digital Edition Editor")])]),e.$store.state.loggedIn?[r("router-link",{attrs:{to:"/"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=(t.isActive,t.isExactActive);return[r("li",{attrs:{role:"presentation"}},[r("a",{attrs:{role:"menuitem",tabindex:"0",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:a}},[e._v("Edition")])])]}}],null,!0)}),e.branch?r("router-link",{attrs:{to:"/branches/"+e.branch.id},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=(t.isActive,t.isExactActive);return[r("li",{attrs:{role:"presentation"}},[r("a",{attrs:{role:"menuitem",tabindex:"-1",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:a}},[e._v(e._s(e.branch.attributes.name))])])]}}],null,!0)}):e._e(),e.file?r("router-link",{attrs:{to:"/branches/"+e.branch.id+"/files/"+e.file.id},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=(t.isActive,t.isExactActive);return[r("li",{attrs:{role:"presentation"}},[r("a",{attrs:{role:"menuitem",tabindex:"-1",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:a}},[e._v(e._s(e.file.attributes.name))])])]}}],null,!0)}):e._e()]:e._e()],2)]}}])}),r("aria-menubar",{scopedSlots:e._u([{key:"default",fn:function(t){var a=t.keyboardNav;return[r("ul",{attrs:{role:"menubar"}},[e.$store.state.loggedIn?r("li",{attrs:{role:"presentation"}},[r("a",{attrs:{role:"menuitem",tabindex:"0"},on:{click:e.logOut}},[e._v("Sign out")])]):r("router-link",{attrs:{to:"/login"},scopedSlots:e._u([{key:"default",fn:function(t){var n=t.href,s=t.navigate,i=(t.isActive,t.isExactActive);return[r("li",{attrs:{role:"presentation"}},[r("a",{attrs:{role:"menuitem",tabindex:"0",href:n,"aria-current":i?"true":"false"},on:{click:s,keyup:a}},[e._v("Sign in")])])]}}],null,!0)})],1)]}}])})],1),r("main",[r("router-view")],1)])},s=[],i=r("d4ec"),o=r("bee2"),u=r("262e"),c=r("2caf"),l=r("9ab4"),d=r("60a3"),h=r("b85c"),p=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){return Object(i["a"])(this,r),t.apply(this,arguments)}return Object(o["a"])(r,[{key:"render",value:function(){if(this.$scopedSlots.default)return this.$scopedSlots.default({keyboardNav:this.keyboardNavigation,mouseClickNav:this.mouseClickNavigation})}},{key:"keyboardNavigation",value:function(e){var t=e.target;if(t)if(39===e.keyCode){var r=this.findNextMenuitem(this.getParentMenubar(t),t,"next");r&&r.focus()}else if(37===e.keyCode){var a=this.findNextMenuitem(this.getParentMenubar(t),t,"previous");a&&a.focus()}else if(38===e.keyCode||40===e.keyCode){if(t.parentElement&&t.parentElement.children){var n,s=Object(h["a"])(t.parentElement.children);try{for(s.s();!(n=s.n()).done;){var i=n.value;if("menu"===i.getAttribute("role")){i.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var o=this.findNextMenuitem(i,null,"next");o&&o.focus()}}}catch(p){s.e(p)}finally{s.f()}}}else if((13===e.keyCode||32==e.keyCode)&&t.parentElement&&t.parentElement.children){var u,c=Object(h["a"])(t.parentElement.children);try{for(c.s();!(u=c.n()).done;){var l=u.value;if("menu"===l.getAttribute("role"))if("false"===l.getAttribute("aria-hidden"))l.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{l.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var d=this.findNextMenuitem(l,null,"next");if(d)return void d.focus()}}}catch(p){c.e(p)}finally{c.f()}t.click()}}},{key:"mouseClickNavigation",value:function(e){var t=e.target;if(t&&t.parentElement&&t.parentElement.children){var r,a=Object(h["a"])(t.parentElement.children);try{for(a.s();!(r=a.n()).done;){var n=r.value;if("menu"===n.getAttribute("role"))if("false"===n.getAttribute("aria-hidden"))n.setAttribute("aria-hidden","true"),t.setAttribute("aria-expanded","false");else{n.setAttribute("aria-hidden","false"),t.setAttribute("aria-expanded","true");var s=this.findNextMenuitem(n,null,"next");if(s)return void s.focus()}}}catch(i){a.e(i)}finally{a.f()}}}},{key:"getParentMenubar",value:function(e){return e?"menubar"===e.getAttribute("role")?e:this.getParentMenubar(e.parentElement):null}},{key:"findNextMenuitem",value:function(e,t,r){if(!e)return null;var a=[];if("next"===r)for(var n=e.children.length-1;n>=0;n--)a.push(e.children[n]);else for(var s=0;s<e.children.length;s++)a.push(e.children[s]);var i=0;t||(i=1);while(a.length>0){var o=a.pop();if(0===i&&o===t)i=1;else if(1===i&&"menuitem"===o.getAttribute("role")&&"true"!==o.getAttribute("aria-disabled"))return o;if("menu"!==o.getAttribute("role"))if("next"===r)for(var u=o.children.length-1;u>=0;u--)a.push(o.children[u]);else for(var c=0;c<o.children.length;c++)a.push(o.children[c])}return null}}]),r}(d["Vue"]);p=Object(l["a"])([Object(d["Component"])({})],p);var f,b,m=p,v=m,g=r("2877"),k=Object(g["a"])(v,f,b,!1,null,null,null),y=k.exports,w=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){return Object(i["a"])(this,r),t.apply(this,arguments)}return Object(o["a"])(r,[{key:"logOut",value:function(){this.$store.commit("setUserId",""),this.$store.commit("setUserToken",""),this.$store.commit("setLoggedIn",!1),this.$router.push({name:"login"})}},{key:"branch",get:function(){return this.$store.state.data.branches&&this.$store.state.data.branches[this.$route.params.bid]?this.$store.state.data.branches[this.$route.params.bid]:null}},{key:"file",get:function(){return this.$store.state.data.files&&this.$store.state.data.files[this.$route.params.fid]?this.$store.state.data.files[this.$route.params.fid]:null}}]),r}(d["Vue"]);w=Object(l["a"])([Object(d["Component"])({components:{AriaMenubar:y}})],w);var x=w,A=x,C=Object(g["a"])(A,n,s,!1,null,null,null),_=C.exports,O=r("8c4f"),j=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"home margin-top"},[e.addBranch?r("aria-dialog",[r("div",{attrs:{role:"dialog","aria-modal":"true"}},[r("form",{staticClass:"flex vertical",on:{submit:e.createBranch}},[r("div",[r("h2",[e._v("Add a Task")]),r("label",[e._v("Task Name "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.newBranchName,expression:"newBranchName"}],attrs:{type:"text"},domProps:{value:e.newBranchName},on:{input:function(t){t.target.composing||(e.newBranchName=t.target.value)}}})])]),r("div",{staticClass:"shrink text-right"},[r("a",{attrs:{tabindex:"0"},on:{click:e.toggleAddBranch}},[e._v("Don't add")]),r("button",{staticClass:"button margin-left",attrs:{tabindex:"0"}},[e._v("Add a Task")])])])])]):e._e(),e.addingBranch?r("aria-dialog",[r("div",{attrs:{role:"dialog","aria-modal":"true"}},[r("div",[r("h2",[e._v("Adding a Task")]),r("p",[e._v("The new task is being created. This might take a few minutes.")])])])]):e._e(),r("div",{staticClass:"width-limited"},[r("div",{staticClass:"flex"},[r("h1",[e._v("Edition Tasks")]),r("a",{staticClass:"shrink with-icon",on:{click:e.toggleAddBranch}},[r("svg",{staticClass:"icon small",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20,12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2M13,7H11V11H7V13H11V17H13V13H17V11H13V7Z"}})]),r("span",[e._v("Add a Task")])])]),0===e.branches.length?r("p",[e._v("There are currently no active tasks. "),r("a",{on:{click:e.toggleAddBranch}},[e._v("Add a Task")]),e._v(".")]):e._e(),r("dl",{staticClass:"detail-list"},[e._l(e.branches,(function(t){return[r("dt",{key:t.id+"-dt",staticClass:"flex"},["active"===t.attributes.status?r("router-link",{attrs:{to:"/branches/"+t.id},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.href,s=a.navigate;return[r("h2",[r("a",{attrs:{href:n},on:{click:s}},[e._v(e._s(t.attributes.name))])])]}}],null,!0)}):r("h2",[e._v(e._s(t.attributes.name))]),r("div",{staticClass:"shrink align-middle"},["active"===t.attributes.status?r("a",{on:{click:function(r){return e.deleteBranch(t)}}},[r("svg",{staticClass:"icon alert",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}})])]):"merged"===t.attributes.status?r("span",{attrs:{title:"This task has been integrated"}},[r("svg",{staticClass:"icon success",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})])]):"deleted"===t.attributes.status?r("span",{attrs:{title:"This task has been deleted"}},[r("svg",{staticClass:"icon warning",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})])]):e._e()])],1),r("dd",{key:t.id+"-dd"},[r("span",[e._v("Started at: "+e._s(e.fancyDate(t.attributes.created)))]),t.attributes.updated?r("span",[[e._v("Last Change: "+e._s(e.fancyDate(t.attributes.updated)))]],2):t.attributes.merged?r("span",[[e._v("Integrated: "+e._s(e.fancyDate(t.attributes.merged)))]],2):t.attributes.deleted?r("span",[[e._v("Deleted: "+e._s(e.fancyDate(t.attributes.deleted)))]],2):r("span"),r("span",[t.attributes.authors&&t.attributes.authors.length>0?[e._v("Edited By: "+e._s(t.attributes.authors.join(", ")))]:e._e()],2)])]}))],2)])],1)},B=[],$=(r("a15b"),r("b0c0"),r("07ac"),r("96cf"),r("1da1")),L=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){return Object(i["a"])(this,r),t.apply(this,arguments)}return Object(o["a"])(r,[{key:"render",value:function(){if(this.$scopedSlots.default)return this.$scopedSlots.default({})}}]),r}(d["Vue"]);L=Object(l["a"])([d["Component"]],L);var R,I,T=L,V=T,D=Object(g["a"])(V,R,I,!1,null,null,null),M=D.exports,S=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.intervalId=-1,e.addBranch=!1,e.addingBranch=!1,e.newBranchName="",e}return Object(o["a"])(r,[{key:"mounted",value:function(){var e=this;this.intervalId=window.setInterval(Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.$store.dispatch("backgroundFetchAll","branches");case 2:case"end":return t.stop()}}),t)}))),6e4)}},{key:"beforeDestroy",value:function(){window.clearInterval(this.intervalId)}},{key:"toggleAddBranch",value:function(e){e.preventDefault(),this.addBranch=!this.addBranch}},{key:"createBranch",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,this.addBranch=!1,this.addingBranch=!0,e.next=6,this.$store.dispatch("createBranch",{type:"branches",attributes:{name:this.newBranchName}});case 6:r=e.sent,this.addingBranch=!0,this.$router.push({name:"branch",params:{bid:r.id}}),e.next=15;break;case 11:e.prev=11,e.t0=e["catch"](1),alert("Unfortunately something went wrong creating a new task"),this.addingBranch=!1;case 15:case"end":return e.stop()}}),e,this,[[1,11]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"deleteBranch",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:confirm("Deleting this task ("+t.attributes.name+") will also delete any changes that have been made there and that have not been integrated into the default copy.\n\nThis cannot be undone.\n\nPlease confirm you wish to proceed.")&&this.$store.dispatch("deleteBranch",t);case 1:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"fancyDate",value:function(e){var t=new Date(e),r=[];return t.getDate()<10&&r.push("0"),r.push(t.getDate()),r.push("."),t.getMonth()<10&&r.push("0"),r.push(t.getMonth()),r.push("."),r.push(t.getFullYear()),r.push(" at "),r.push(t.getHours()),r.push(":"),r.push(t.getMinutes()),r.join("")}},{key:"branches",get:function(){if(this.$store.state.data.branches){var e=Object.values(this.$store.state.data.branches);return e.sort((function(e,t){var r,a;if(e.attributes.updated?r=new Date(e.attributes.updated):e.attributes.merged?r=new Date(e.attributes.merged):e.attributes.deleted?r=new Date(e.attributes.deleted):e.attributes.created&&(r=new Date(e.attributes.created)),t.attributes.updated?a=new Date(t.attributes.updated):t.attributes.merged?a=new Date(t.attributes.merged):t.attributes.deleted?a=new Date(t.attributes.deleted):t.attributes.created&&(a=new Date(t.attributes.created)),r&&a){if(r>a)return-1;if(r<a)return 1}return e.attributes.title<t.attributes.title?-1:e.attributes.title>t.attributes.title?1:0})),e}return[]}}]),r}(d["Vue"]);S=Object(l["a"])([Object(d["Component"])({components:{AriaDialog:M}})],S);var E=S,U=E,H=Object(g["a"])(U,j,B,!1,null,null,null),P=H.exports,N=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"login width-limited margin-top"},[r("h1",[e._v("Sign in")]),r("form",{staticClass:"flex",on:{submit:e.login}},[r("label",[e._v("E-Mail Address "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.email,expression:"email"}],attrs:{type:"email"},domProps:{value:e.email},on:{input:function(t){t.target.composing||(e.email=t.target.value)}}}),e.errors.email?r("span",{staticClass:"error-msg"},[e._v(e._s(e.errors.email))]):e._e()]),r("label",[e._v("Password "),r("input",{directives:[{name:"model",rawName:"v-model",value:e.password,expression:"password"}],attrs:{type:"password"},domProps:{value:e.password},on:{input:function(t){t.target.composing||(e.password=t.target.value)}}}),e.errors.password?r("span",{staticClass:"error-msg"},[e._v(e._s(e.errors.email))]):e._e()]),r("span",{staticClass:"align-end shrink"},[r("button",{staticClass:"button"},[e._v("Sign in")]),e.errors.email||e.errors.password?r("span",{staticClass:"error-msg empty"}):e._e()])])])},X=[],F=(r("99af"),r("4160"),r("d81d"),r("13d5"),r("d3b7"),r("ac1f"),r("3ca3"),r("1276"),r("159b"),r("ddb0"),r("ade3")),Z=r("2f62"),z=r("bc3a"),q=r.n(z);function J(e,t,r){var a={},n=e.getItem("digi_edit:storage");n&&(a=JSON.parse(n));for(var s=t.split("."),i=a,o=0;o<s.length;o++){var u=s[o];o===s.length-1?i[u]=r:(i[u]||(i[u]={}),i=i[u])}e.setItem("digi_edit:storage",JSON.stringify(a))}function G(e,t,r){var a=e.getItem("digi_edit:storage");if(a)for(var n=JSON.parse(a),s=t.split("."),i=n,o=0;o<s.length;o++){var u=s[o];if(o===s.length-1)return void 0!==i[u]?i[u]:r;if(!i[u])return r;i=i[u]}return r}function Y(e,t){J(sessionStorage,e,t)}function K(e,t){return G(sessionStorage,e,t)}function Q(e){return e.response?e.response.data.errors.reduce((function(e,t){var r=t.source.pointer.split("/");return e[r[r.length-1]]=t.title,e}),{}):{}}a["a"].use(Z["a"]);var W=new Z["a"].Store({state:{config:{api:{baseURL:"",configURL:""}},data:{},userId:"",userToken:"",loggedIn:!1,busy:!1,busyCounter:0,maxBusyCounter:0,completedBusyCounter:0},mutations:{setConfig:function(e,t){e.config=t},setConfigSection:function(e,t){a["a"].set(e.config,t.type,t.data)},setUserId:function(e,t){e.userId=t,Y("user.id",t)},setUserToken:function(e,t){e.userToken=t,Y("user.token",t)},setLoggedIn:function(e,t){e.loggedIn=t,Y("user.loggedIn",t)},setObject:function(e,t){e.data[t.type]?a["a"].set(e.data[t.type],t.id,t):a["a"].set(e.data,t.type,Object(F["a"])({},t.id,t))},deleteObject:function(e,t){e.data[t.type]&&a["a"].delete(e.data[t.type],t.id)},setBusy:function(e,t){t?(e.busyCounter=e.busyCounter+1,e.maxBusyCounter=e.maxBusyCounter+1):(e.busyCounter=e.busyCounter-1,e.completedBusyCounter=e.completedBusyCounter+1),0===e.busyCounter?setTimeout((function(){e.busy=!1,e.maxBusyCounter=0,e.completedBusyCounter=0}),300):e.busy=!0}},actions:{init:function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(r=e.dispatch,a=e.commit,n=e.state,a("setUserId",K("user.id","")),a("setUserToken",K("user.token","")),a("setLoggedIn",K("user.loggedIn","")),r("loadConfig","tei-schema"),!n.loggedIn||""===n.userId||""===n.userToken){t.next=12;break}return t.next=8,r("loadUser");case 8:return t.next=10,r("loadBranches");case 10:t.next=13;break;case 12:Ve.push({name:"login"});case 13:case"end":return t.stop()}}),t)})))()},loadConfig:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q.a.get(n.config.api.configURL+"/tei-schema");case 5:s=r.sent,a("setConfigSection",{type:t,data:s.data}),a("setBusy",!1),r.next=13;break;case 10:r.prev=10,r.t0=r["catch"](1),a("setBusy",!1);case 13:case"end":return r.stop()}}),r,null,[[1,10]])})))()},loadUser:function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var r,a;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,a=e.state,t.next=3,r("fetchSingle",{type:"users",id:a.userId});case 3:case"end":return t.stop()}}),t)})))()},loadBranches:function(e){return Object($["a"])(regeneratorRuntime.mark((function t(){var r,a,n;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return r=e.dispatch,t.next=3,r("fetchAll","branches");case 3:return a=t.sent,n=[],a.forEach((function(e){e.relationships.files&&(n=n.concat(e.relationships.files.data.map((function(e){return r("loadFile",e)}))))})),t.next=8,Promise.all(n);case 8:return t.abrupt("return",a);case 9:case"end":return t.stop()}}),t)})))()},createBranch:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,r.next=3,a("createSingle",t);case 3:return t=r.sent,n=t.relationships.files.data.map((function(e){return a("loadFile",e)})),r.next=7,Promise.all(n);case 7:return r.abrupt("return",t);case 8:case"end":return r.stop()}}),r)})))()},loadBranch:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,r.next=3,a("fetchSingle",t);case 3:return t=r.sent,n=t.relationships.files.data.map((function(e){return a("loadFile",e)})),r.next=7,Promise.all(n);case 7:return r.abrupt("return",t);case 8:case"end":return r.stop()}}),r)})))()},deleteBranch:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,n=e.commit,r.next=3,a("deleteSingle",t);case 3:t.relationships.files.data.forEach((function(e){n("deleteObject",e)}));case 4:case"end":return r.stop()}}),r)})))()},loadFile:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,r.next=3,a("fetchSingle",t);case 3:return n=r.sent,r.abrupt("return",n);case 5:case"end":return r.stop()}}),r)})))()},fetchAll:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q()({method:"GET",url:n.config.api.baseURL+"/"+t,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return s=r.sent.data,s.data.forEach((function(e){a("setObject",e)})),a("setBusy",!1),r.abrupt("return",s.data);case 11:if(r.prev=11,r.t0=r["catch"](1),a("setBusy",!1),401!==r.t0.response.status){r.next=21;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=22;break;case 21:throw r.t0;case 22:case"end":return r.stop()}}),r,null,[[1,11]])})))()},backgroundFetchAll:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,r.next=4,q()({method:"GET",url:n.config.api.baseURL+"/"+t,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 4:return s=r.sent.data,s.data.forEach((function(e){a("setObject",e)})),r.abrupt("return",s.data);case 9:if(r.prev=9,r.t0=r["catch"](1),401!==r.t0.response.status){r.next=18;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=19;break;case 18:throw r.t0;case 19:case"end":return r.stop()}}),r,null,[[1,9]])})))()},fetchSingle:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q()({method:"GET",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return s=r.sent.data.data,a("setObject",s),a("setBusy",!1),r.abrupt("return",s);case 11:if(r.prev=11,r.t0=r["catch"](1),a("setBusy",!1),401!==r.t0.response.status){r.next=21;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=22;break;case 21:throw r.t0;case 22:case"end":return r.stop()}}),r,null,[[1,11]])})))()},backgroundFetchSingle:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,r.next=4,q()({method:"GET",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 4:return s=r.sent.data.data,a("setObject",s),r.abrupt("return",s);case 9:if(r.prev=9,r.t0=r["catch"](1),401!==r.t0.response.status){r.next=18;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=19;break;case 18:throw r.t0;case 19:case"end":return r.stop()}}),r,null,[[1,9]])})))()},createSingle:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q()({method:"POST",url:n.config.api.baseURL+"/"+t.type,data:{data:t},headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return t=r.sent.data.data,a("setObject",t),a("setBusy",!1),r.abrupt("return",t);case 11:if(r.prev=11,r.t0=r["catch"](1),a("setBusy",!1),401!==r.t0.response.status){r.next=21;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=22;break;case 21:throw r.t0;case 22:case"end":return r.stop()}}),r,null,[[1,11]])})))()},saveSingle:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q()({method:"PATCH",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,data:{data:t},headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:return t=r.sent.data.data,a("setObject",t),a("setBusy",!1),r.abrupt("return",t);case 11:if(r.prev=11,r.t0=r["catch"](1),a("setBusy",!1),401!==r.t0.response.status){r.next=21;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=22;break;case 21:throw r.t0;case 22:case"end":return r.stop()}}),r,null,[[1,11]])})))()},deleteSingle:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q()({method:"DELETE",url:n.config.api.baseURL+"/"+t.type+"/"+t.id,headers:{"X-Authorization":n.userId+" "+n.userToken}});case 5:s=r.sent,200===s.status?a("setObject",s.data.data):a("deleteObject",t),a("setBusy",!1),r.next=21;break;case 10:if(r.prev=10,r.t0=r["catch"](1),a("setBusy",!1),401!==r.t0.response.status){r.next=20;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=21;break;case 20:throw r.t0;case 21:case"end":return r.stop()}}),r,null,[[1,10]])})))()},login:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s,i;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.dispatch,n=e.commit,s=e.state,r.prev=1,n("setBusy",!0),r.next=5,q()({method:"POST",url:s.config.api.baseURL+"/login",data:{data:{type:"users",attributes:t}},headers:{"X-Authorization":s.userId+" "+s.userToken}});case 5:return i=r.sent,n("setUserId",i.data.id),n("setUserToken",i.data.attributes.token),n("setLoggedIn",!0),r.next=11,a("init");case 11:Ve.push({name:"root"}),n("setBusy",!1),r.next=19;break;case 15:throw r.prev=15,r.t0=r["catch"](1),n("setBusy",!1),r.t0;case 19:case"end":return r.stop()}}),r,null,[[1,15]])})))()},action:function(e,t){return Object($["a"])(regeneratorRuntime.mark((function r(){var a,n,s;return regeneratorRuntime.wrap((function(r){while(1)switch(r.prev=r.next){case 0:return a=e.commit,n=e.state,r.prev=1,a("setBusy",!0),r.next=5,q()({method:"POST",url:n.config.api.baseURL+"/"+t.obj.type+"/"+t.obj.id,headers:{"X-Authorization":n.userId+" "+n.userToken,"X-Action":t.action}});case 5:return s=r.sent.data.data,a("setObject",s),a("setBusy",!1),r.abrupt("return",s);case 11:if(r.prev=11,r.t0=r["catch"](1),a("setBusy",!1),401!==r.t0.response.status){r.next=21;break}a("setUserId",""),a("setUserToken",""),a("setLoggedIn",""),Ve.push({name:"login"}),r.next=22;break;case 21:throw r.t0;case 22:case"end":return r.stop()}}),r,null,[[1,11]])})))()}},modules:{}}),ee=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.email="",e.password="",e.errors={},e}return Object(o["a"])(r,[{key:"login",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,this.errors={},e.next=5,this.$store.dispatch("login",{email:this.email,password:this.password});case 5:e.next=10;break;case 7:e.prev=7,e.t0=e["catch"](1),this.errors=Q(e.t0);case 10:case"end":return e.stop()}}),e,this,[[1,7]])})));function t(t){return e.apply(this,arguments)}return t}()}]),r}(d["Vue"]);ee=Object(l["a"])([d["Component"]],ee);var te=ee,re=te,ae=Object(g["a"])(re,N,X,!1,null,null,null),ne=ae.exports,se=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.isCurrentRoute?r("div",{staticClass:"branch margin-top"},[e.branch?r("div",{staticClass:"width-limited"},[r("div",[r("h1",[e._v(e._s(e.branch.attributes.name))])]),"active"===e.branch.attributes.status?r("div",{staticClass:"flex"},[r("dl",{staticClass:"detail-list flex-75"},[e._l(e.fileSets,(function(t){return[r("dt",{key:t.id+"-dt"},[r("h2",[e._v(e._s(t.id))])]),r("dd",{key:t.id+"-dd"},[r("ul",{staticClass:"no-bullet"},e._l(t.files,(function(t){return r("li",{key:t.id},[r("router-link",{attrs:{to:"/branches/"+e.branch.id+"/files/"+t.id},scopedSlots:e._u([{key:"default",fn:function(a){var n=a.href,s=a.navigate;return[r("a",{attrs:{href:n},on:{click:s}},[e._v(e._s(t.attributes.name))])]}}],null,!0)})],1)})),0)])]}))],2),r("div",{staticClass:"flex-25 padding-left"},[r("ul",{staticClass:"no-bullet margin-bottom"},[e.branch.attributes.updates?r("li",{staticClass:"margin-bottom"},[r("a",{staticClass:"button outline full-width text-center",on:{click:e.rebase}},[r("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M7,3A3,3 0 0,1 10,6C10,7.29 9.19,8.39 8.04,8.81C8.58,13.81 13.08,14.77 15.19,14.96C15.61,13.81 16.71,13 18,13A3,3 0 0,1 21,16A3,3 0 0,1 18,19C16.69,19 15.57,18.16 15.16,17C10.91,16.8 9.44,15.19 8,13.39V15.17C9.17,15.58 10,16.69 10,18A3,3 0 0,1 7,21A3,3 0 0,1 4,18C4,16.69 4.83,15.58 6,15.17V8.83C4.83,8.42 4,7.31 4,6A3,3 0 0,1 7,3M7,5A1,1 0 0,0 6,6A1,1 0 0,0 7,7A1,1 0 0,0 8,6A1,1 0 0,0 7,5M7,17A1,1 0 0,0 6,18A1,1 0 0,0 7,19A1,1 0 0,0 8,18A1,1 0 0,0 7,17M18,15A1,1 0 0,0 17,16A1,1 0 0,0 18,17A1,1 0 0,0 19,16A1,1 0 0,0 18,15Z"}})]),e._v(" Update ")])]):e._e(),r("li",{staticClass:"margin-bottom"},[e.branch.attributes.pull_request&&"open"===e.branch.attributes.pull_request.state?r("a",{staticClass:"button outline full-width text-center",on:{click:e.cancelIntegration}},[r("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})]),e._v(" Cancel integration ")]):r("a",{staticClass:"button outline full-width text-center",on:{click:e.requestIntegration}},[r("svg",{staticClass:"icon",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M6,3A3,3 0 0,1 9,6C9,7.31 8.17,8.42 7,8.83V15.17C8.17,15.58 9,16.69 9,18A3,3 0 0,1 6,21A3,3 0 0,1 3,18C3,16.69 3.83,15.58 5,15.17V8.83C3.83,8.42 3,7.31 3,6A3,3 0 0,1 6,3M6,5A1,1 0 0,0 5,6A1,1 0 0,0 6,7A1,1 0 0,0 7,6A1,1 0 0,0 6,5M6,17A1,1 0 0,0 5,18A1,1 0 0,0 6,19A1,1 0 0,0 7,18A1,1 0 0,0 6,17M21,18A3,3 0 0,1 18,21A3,3 0 0,1 15,18C15,16.69 15.83,15.58 17,15.17V7H15V10.25L10.75,6L15,1.75V5H17A2,2 0 0,1 19,7V15.17C20.17,15.58 21,16.69 21,18M18,17A1,1 0 0,0 17,18A1,1 0 0,0 18,19A1,1 0 0,0 19,18A1,1 0 0,0 18,17Z"}})]),e._v(" Request integration ")])]),r("li",{staticClass:"margin-bottom"},[r("a",{staticClass:"button outline full-width text-center",on:{click:e.rescan}},[r("svg",{staticClass:"icon alert",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,13H13V19H11V13H5V11H11V5H13V11H19V13Z"}})]),e._v(" Add File ")])]),r("li",{staticClass:"margin-bottom"},[r("a",{staticClass:"button outline full-width text-center",on:{click:e.deleteBranch}},[r("svg",{staticClass:"icon alert",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,4H15.5L14.5,3H9.5L8.5,4H5V6H19M6,19A2,2 0 0,0 8,21H16A2,2 0 0,0 18,19V7H6V19Z"}})]),e._v(" Delete ")])])]),e.branch.attributes.pull_request&&"open"==e.branch.attributes.pull_request.state?[r("h3",{staticClass:"no-margin"},[e._v("Integration reviews")]),r("dl",{staticClass:"margin-bottom"},[e._l(e.branch.attributes.pull_request.reviews,(function(t,a){return[r("dt",{key:a+"-dt",staticClass:"flex"},[r("span",[e._v(e._s(t.user))]),"APPROVED"===t.state?r("svg",{staticClass:"shrink icon success",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"}})]):r("svg",{staticClass:"shrink icon warning",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}})])]),r("dd",{key:a+"-dd",staticClass:"no-margin margin-bottom"},[e._v(e._s(t.body))])]})),e.branch.attributes.updates?[r("dt",{staticClass:"flex"},[r("span",[e._v("Automatic Reviews")]),r("svg",{staticClass:"shrink icon warning",attrs:{viewBox:"0 0 24 24"}},[r("path",{attrs:{d:"M19,6.41L17.59,5L12,10.59L6.41,5L5,6.41L10.59,12L5,17.59L6.41,19L12,13.41L17.59,19L19,17.59L13.41,12L19,6.41Z"}})])]),r("dd",{staticClass:"no-margin margin-bottom"},[e._v("This task needs to be updated before the integration can proceed")])]:e._e()],2)]:e._e(),e.branch.attributes.changes?[r("h3",{staticClass:"no-margin"},[e._v("Changed Files ("+e._s(e.branch.attributes.changes.length)+")")]),r("ul",{staticClass:"no-bullet"},e._l(e.branch.attributes.changes,(function(t){return r("li",{key:t,attrs:{title:t}},[e._v(e._s(t))])})),0)]:e._e()],2)]):"merged"===e.branch.attributes.status?r("div",[r("p",[e._v("This task has been integrated into the primary copy.")])]):"deleted"===e.branch.attributes.status?r("div",[r("p",[e._v("This task has been deleted.")])]):e._e()]):e._e()]):r("router-view")},ie=[],oe=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.intervalId=-1,e}return Object(o["a"])(r,[{key:"mounted",value:function(){var e=this;this.intervalId=window.setInterval(Object($["a"])(regeneratorRuntime.mark((function t(){return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(!e.branch){t.next=9;break}return t.prev=1,t.next=4,e.$store.dispatch("backgroundFetchSingle",e.branch);case 4:t.next=9;break;case 6:t.prev=6,t.t0=t["catch"](1),404==t.t0.response.status&&(e.$store.commit("deleteObject",e.branch),e.$store.dispatch("loadBranches"),e.$router.push({name:"root"}));case 9:case"end":return t.stop()}}),t,null,[[1,6]])}))),1e4)}},{key:"beforeDestroy",value:function(){window.clearInterval(this.intervalId)}},{key:"deleteBranch",value:function(e){e.preventDefault(),this.branch&&confirm("Deleting this task ("+this.branch.attributes.name+") will also delete any changes that have been made there and that have not been integrated into the default copy.\n\nThis cannot be undone.\n\nPlease confirm you wish to proceed.")&&(this.$store.dispatch("deleteBranch",this.branch),this.$router.push({name:"root"}))}},{key:"requestIntegration",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=4;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"request-integration"});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"cancelIntegration",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=4;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"cancel-integration"});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"rebase",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=4;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"rebase"});case 4:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"rescan",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(t.preventDefault(),!this.branch){e.next=6;break}return e.next=4,this.$store.dispatch("action",{obj:this.branch,action:"rescan"});case 4:return e.next=6,this.$store.dispatch("loadBranch",this.branch);case 6:case"end":return e.stop()}}),e,this)})));function t(t){return e.apply(this,arguments)}return t}()},{key:"branch",get:function(){return this.$store.state.data.branches&&this.$store.state.data.branches[this.$route.params.bid]?this.$store.state.data.branches[this.$route.params.bid]:null}},{key:"fileSets",get:function(){var e=this;if(this.branch&&this.$store.state.data.files){var t=[],r=null;return this.branch.relationships.files&&(this.branch.relationships.files.data.forEach((function(a){if(a.id&&e.$store.state.data.files[a.id]){var n=e.$store.state.data.files[a.id];r&&r.id===n.attributes.path||(r&&t.push(r),r={id:n.attributes.path,files:[]}),r.files.push(n)}})),r&&t.push(r)),t}return[]}},{key:"isCurrentRoute",get:function(){return"branch"===this.$route.name}}]),r}(d["Vue"]);oe=Object(l["a"])([d["Component"]],oe);var ue=oe,ce=ue,le=Object(g["a"])(ce,se,ie,!1,null,null,null),de=le.exports,he=function(){var e=this,t=e.$createElement,r=e._self._c||t;return e.file?r("div",{staticClass:"editor"},[e.fileData&&"text"===e.fileData.attributes.mode?r("text-editor",{attrs:{text:e.fileData.attributes.rawData},on:{save:e.save}}):e._e(),e.config&&e.fileData&&"tei"===e.fileData.attributes.mode?r("tei-editor",{attrs:{config:e.config,autoLoadCallback:e.loadFileDataCallback},on:{save:e.save}}):e._e()],1):e._e()},pe=[],fe=r("4979"),be=r.n(fe),me=r("c154"),ve=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"text-editor flex vertical"},[r("nav",{staticClass:"shrink"},[r("ul",{attrs:{role:"menubar"}},[r("li",{attrs:{role:"presentation"}},[r("a",{attrs:{role:"menuitem"},on:{click:e.save}},[e._v(" Save ")])])])]),r("div",{ref:"editorElement"})])},ge=[],ke=(r("25f0"),r("742d")),ye=r("dd8b"),we=r("f720"),xe=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.editorView=null,e}return Object(o["a"])(r,[{key:"mounted",value:function(){this.loadEditor()}},{key:"save",value:function(e){e.preventDefault(),this.editorView&&this.$emit("save",this.editorView.state.doc.toString())}},{key:"loadEditor",value:function(){if(!this.editorView&&this.$refs.editorElement){var e=ke["d"].create({doc:"",extensions:[Object(ye["d"])(we["a"])]});this.editorView=new ye["c"]({state:e,parent:this.$refs.editorElement})}if(this.editorView&&this.text){var t=ke["d"].create({doc:this.text,extensions:[Object(ye["d"])(we["a"])]});this.editorView.setState(t)}}}]),r}(d["Vue"]);Object(l["a"])([Object(d["Prop"])()],xe.prototype,"text",void 0),xe=Object(l["a"])([d["Component"]],xe);var Ae=xe,Ce=Ae,_e=Object(g["a"])(Ce,ve,ge,!1,null,null,null),Oe=_e.exports,je=function(e){Object(u["a"])(r,e);var t=Object(c["a"])(r);function r(){var e;return Object(i["a"])(this,r),e=t.apply(this,arguments),e.fileData=null,e}return Object(o["a"])(r,[{key:"mounted",value:function(){var e=this;this.$store.commit("setBusy",!0),q()({method:"GET",url:this.$store.state.config.api.baseURL+"/files/"+this.$route.params.fid,headers:{"X-Authorization":this.$store.state.userId+" "+this.$store.state.userToken,"X-Include-Data":!0}}).then((function(t){e.fileData=t.data.data,e.$store.commit("setBusy",!1)}),(function(t){e.$store.commit("setBusy",!1),401===t.response.status&&(e.$store.commit("setUserId",""),e.$store.commit("setUserToken",""),e.$store.commit("setLoggedIn",""),e.$router.push({name:"login"}))}))}},{key:"save",value:function(){var e=Object($["a"])(regeneratorRuntime.mark((function e(t){var r;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return e.prev=0,r=be()(this.fileData),r.attributes.rawData=t,this.$store.commit("setBusy",!0),e.next=6,q()({method:"PATCH",url:this.$store.state.config.api.baseURL+"/files/"+this.$route.params.fid,headers:{"X-Authorization":this.$store.state.userId+" "+this.$store.state.userToken,"X-Include-Data":!0},data:{data:r}});case 6:this.$store.commit("setBusy",!1),e.next=13;break;case 9:e.prev=9,e.t0=e["catch"](0),this.$store.commit("setBusy",!1),401===e.t0.response.status&&(this.$store.commit("setUserId",""),this.$store.commit("setUserToken",""),this.$store.commit("setLoggedIn",""),this.$router.push({name:"login"}));case 13:case"end":return e.stop()}}),e,this,[[0,9]])})));function t(t){return e.apply(this,arguments)}return t}()},{key:"loadFileDataCallback",value:function(e){this.fileData&&this.fileData.attributes.rawData&&e(this.fileData.attributes.rawData)}},{key:"file",get:function(){return this.$store.state.data.files&&this.$store.state.data.files[this.$route.params.fid]?this.$store.state.data.files[this.$route.params.fid]:null}},{key:"config",get:function(){return this.$store.state.config["tei-schema"]?this.$store.state.config["tei-schema"]:null}}]),r}(d["Vue"]);je=Object(l["a"])([Object(d["Component"])({components:{TextEditor:Oe,TeiEditor:me["TeiEditor"]}})],je);var Be=je,$e=Be,Le=Object(g["a"])($e,he,pe,!1,null,null,null),Re=Le.exports;a["a"].use(O["a"]);var Ie=[{path:"/",name:"root",component:P},{path:"/login",name:"login",component:ne},{path:"/branches/:bid",name:"branch",component:de,children:[{path:"files/:fid",name:"file",component:Re}]}],Te=new O["a"]({mode:"history",base:"/ui/",routes:Ie}),Ve=Te;a["a"].config.productionTip=!1;var De=document.querySelector("#DigiEditConfig");if(De){var Me=JSON.parse(De.innerHTML);W.commit("setConfig",Me),W.dispatch("init")}new a["a"]({router:Ve,store:W,render:function(e){return e(_)}}).$mount("#app")}});
//# sourceMappingURL=app.js.map